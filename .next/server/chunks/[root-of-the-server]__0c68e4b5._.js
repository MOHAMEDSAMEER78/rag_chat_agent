module.exports = {

"[project]/.next-internal/server/app/api/chat/route/actions.js [app-rsc] (server actions loader, ecmascript)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
}}),
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/@opentelemetry/api [external] (@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("@opentelemetry/api", () => require("@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/node:crypto [external] (node:crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:crypto", () => require("node:crypto"));

module.exports = mod;
}}),
"[externals]/crypto [external] (crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}}),
"[project]/app/lib/vectorStore.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "getVectorStore": (()=>getVectorStore),
    "initializeEmbeddings": (()=>initializeEmbeddings),
    "initializeVectorStore": (()=>initializeVectorStore),
    "processAndStorePDFContent": (()=>processAndStorePDFContent),
    "processAndStoreWebContent": (()=>processAndStoreWebContent),
    "queryVectorStore": (()=>queryVectorStore)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$community$2f$vectorstores$2f$chroma$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/@langchain/community/vectorstores/chroma.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$community$2f$dist$2f$vectorstores$2f$chroma$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@langchain/community/dist/vectorstores/chroma.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$google$2d$genai$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/@langchain/google-genai/index.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$google$2d$genai$2f$dist$2f$embeddings$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@langchain/google-genai/dist/embeddings.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$documents$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/@langchain/core/documents.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$documents$2f$document$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@langchain/core/dist/documents/document.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$langchain$2f$text_splitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/langchain/text_splitter.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$textsplitters$2f$dist$2f$text_splitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@langchain/textsplitters/dist/text_splitter.js [app-route] (ecmascript)");
;
;
;
;
// Initialize embeddings model
let embeddings;
let vectorStore = null;
let isVectorStoreAvailable = true;
function initializeEmbeddings(apiKey) {
    embeddings = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$google$2d$genai$2f$dist$2f$embeddings$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["GoogleGenerativeAIEmbeddings"]({
        apiKey: apiKey,
        model: 'embedding-001'
    });
}
async function initializeVectorStore() {
    if (!embeddings) {
        throw new Error('Embeddings model is not initialized');
    }
    try {
        vectorStore = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$community$2f$dist$2f$vectorstores$2f$chroma$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Chroma"](embeddings, {
            collectionName: 'angel_one_support',
            url: process.env.CHROMA_URL || 'http://localhost:8000'
        });
        // Test the connection by performing a small query
        await vectorStore.similaritySearch("test connection", 1);
        isVectorStoreAvailable = true;
        return vectorStore;
    } catch (error) {
        console.error('Error initializing vector store:', error);
        isVectorStoreAvailable = false;
        vectorStore = null;
        throw new Error('Failed to initialize vector store. Is Chroma running?');
    }
}
async function getVectorStore() {
    if (!isVectorStoreAvailable) {
        // Try to reinitialize if previously marked as unavailable
        try {
            return await initializeVectorStore();
        } catch (error) {
            console.error('Vector store is still unavailable:', error);
            throw error;
        }
    }
    if (!vectorStore) {
        try {
            await initializeVectorStore();
        } catch (error) {
            console.error('Failed to initialize vector store:', error);
            throw error;
        }
    }
    return vectorStore;
}
async function processAndStoreWebContent(scrapeResults) {
    try {
        const store = await getVectorStore();
        if (!store) {
            console.error('Vector store is not available');
            return 0;
        }
        // Create a text splitter to break content into chunks
        const textSplitter = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$textsplitters$2f$dist$2f$text_splitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["RecursiveCharacterTextSplitter"]({
            chunkSize: 1000,
            chunkOverlap: 200
        });
        const documents = [];
        // Process each scraped content
        for (const result of scrapeResults){
            if (!result.content) continue;
            // Split the content into chunks
            const textChunks = await textSplitter.splitText(result.content);
            // Create a document for each chunk
            for (const chunk of textChunks){
                documents.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$documents$2f$document$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Document"]({
                    pageContent: chunk,
                    metadata: {
                        source: result.url,
                        title: result.title,
                        type: 'web'
                    }
                }));
            }
        }
        console.log(`Storing ${documents.length} documents from web content`);
        // Add documents to the vector store
        if (documents.length > 0) {
            await store.addDocuments(documents);
        }
        return documents.length;
    } catch (error) {
        console.error('Error processing web content:', error);
        return 0;
    }
}
async function processAndStorePDFContent(pdfContents) {
    try {
        const store = await getVectorStore();
        if (!store) {
            console.error('Vector store is not available');
            return 0;
        }
        // Create a text splitter to break content into chunks
        const textSplitter = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$textsplitters$2f$dist$2f$text_splitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["RecursiveCharacterTextSplitter"]({
            chunkSize: 1000,
            chunkOverlap: 200
        });
        const documents = [];
        // Process each PDF
        for (const pdf of pdfContents){
            if (!pdf.content) continue;
            // Split the content into chunks
            const textChunks = await textSplitter.splitText(pdf.content);
            // Create a document for each chunk
            for (const chunk of textChunks){
                documents.push(new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$documents$2f$document$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Document"]({
                    pageContent: chunk,
                    metadata: {
                        source: pdf.filename,
                        type: 'pdf'
                    }
                }));
            }
        }
        console.log(`Storing ${documents.length} documents from PDF content`);
        // Add documents to the vector store
        if (documents.length > 0) {
            await store.addDocuments(documents);
        }
        return documents.length;
    } catch (error) {
        console.error('Error processing PDF content:', error);
        return 0;
    }
}
async function queryVectorStore(query, k = 5) {
    try {
        const store = await getVectorStore();
        if (!store) {
            console.error('Vector store is not available');
            return [];
        }
        // Perform similarity search
        const results = await store.similaritySearch(query, k);
        return results;
    } catch (error) {
        console.error('Error querying vector store:', error);
        isVectorStoreAvailable = false; // Mark as unavailable for future calls
        return [];
    }
}
}}),
"[project]/app/lib/chatModel.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "generateResponse": (()=>generateResponse),
    "initializeChatModel": (()=>initializeChatModel),
    "isWithinSupportScope": (()=>isWithinSupportScope)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$google$2d$genai$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/@langchain/google-genai/index.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$google$2d$genai$2f$dist$2f$chat_models$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@langchain/google-genai/dist/chat_models.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$output_parsers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/@langchain/core/output_parsers.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$output_parsers$2f$string$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@langchain/core/dist/output_parsers/string.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$prompts$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/@langchain/core/prompts.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$prompts$2f$chat$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@langchain/core/dist/prompts/chat.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$runnables$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/@langchain/core/runnables.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$runnables$2f$base$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@langchain/core/dist/runnables/base.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$lib$2f$vectorStore$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/lib/vectorStore.ts [app-route] (ecmascript)");
;
;
;
;
;
let model;
function initializeChatModel(apiKey) {
    model = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$google$2d$genai$2f$dist$2f$chat_models$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ChatGoogleGenerativeAI"]({
        apiKey: apiKey,
        model: 'gemini-1.5-pro',
        temperature: 0.2
    });
}
// Create a formatter function for retrieved documents
function formatDocumentsAsChatContext(documents) {
    return documents.map((doc, i)=>{
        const source = doc.metadata.source || 'Unknown source';
        return `Document ${i + 1} (Source: ${source})\n${doc.pageContent}\n`;
    }).join('\n\n');
}
async function isWithinSupportScope(query) {
    try {
        // Attempt to retrieve relevant documents 
        const results = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$lib$2f$vectorStore$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["queryVectorStore"])(query, 3);
        // If we found ANY relevant documents, consider it in scope
        return results.length > 0;
    } catch (error) {
        console.error('Error checking support scope:', error);
        // If there's an error accessing the vector store, return false
        return false;
    }
}
async function generateResponse(query) {
    // Check if the model is initialized
    if (!model) {
        throw new Error('Chat model is not initialized');
    }
    try {
        // First, check if the query is within the support scope
        const inScope = await isWithinSupportScope(query);
        if (!inScope) {
            // If no relevant documents, or vector store is not available
            if (model) {
                // Use the model to generate a fallback response without RAG
                return await generateBasicResponse(query);
            } else {
                return "I don't know. Also, the knowledge base is not available.";
            }
        }
        // Retrieve relevant documents
        const documents = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$lib$2f$vectorStore$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["queryVectorStore"])(query, 5);
        // Format the documents as context
        const context = formatDocumentsAsChatContext(documents);
        // Create a system prompt that instructs the model to only use provided information
        const systemTemplate = `You are a helpful customer support agent for Angel One, a financial services company.
      Answer the user's question based ONLY on the information provided in the context below.
      If the answer cannot be determined from the context, respond with "I don't know."
      Do not make up or infer information that is not explicitly stated in the context.
      
      Context:
      {context}`;
        // Create a prompt template
        const chatPrompt = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$prompts$2f$chat$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ChatPromptTemplate"].fromMessages([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$prompts$2f$chat$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["SystemMessagePromptTemplate"].fromTemplate(systemTemplate),
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$prompts$2f$chat$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["HumanMessagePromptTemplate"].fromTemplate('{query}')
        ]);
        // Create a chain
        const chain = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$runnables$2f$base$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["RunnableSequence"].from([
            {
                query: (input)=>input.query,
                context: (input)=>context
            },
            chatPrompt,
            model,
            new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$output_parsers$2f$string$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["StringOutputParser"]()
        ]);
        // Run the chain
        const response = await chain.invoke({
            query: query
        });
        return response;
    } catch (error) {
        console.error('Error generating response:', error);
        return "I'm having trouble accessing my knowledge base. Please try again later.";
    }
}
// Fallback function when vector store is not available
async function generateBasicResponse(query) {
    try {
        const systemTemplate = `You are a helpful customer support agent for Angel One, a financial services company.
      Answer the user's question to the best of your ability.
      If you don't know the answer, respond with "I don't know."
      State that the knowledge base is currently unavailable, but you'll try to help with general information.`;
        const chatPrompt = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$prompts$2f$chat$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ChatPromptTemplate"].fromMessages([
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$prompts$2f$chat$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["SystemMessagePromptTemplate"].fromTemplate(systemTemplate),
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$prompts$2f$chat$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["HumanMessagePromptTemplate"].fromTemplate('{query}')
        ]);
        const chain = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$runnables$2f$base$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["RunnableSequence"].from([
            {
                query: (input)=>input.query
            },
            chatPrompt,
            model,
            new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$langchain$2f$core$2f$dist$2f$output_parsers$2f$string$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["StringOutputParser"]()
        ]);
        const response = await chain.invoke({
            query: query
        });
        return response;
    } catch (error) {
        console.error('Error generating fallback response:', error);
        return "I'm having trouble right now. Please try again later.";
    }
}
}}),
"[project]/app/api/chat/route.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "POST": (()=>POST)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$lib$2f$chatModel$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/lib/chatModel.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$lib$2f$vectorStore$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/lib/vectorStore.ts [app-route] (ecmascript)");
;
;
;
// Initialize the models with API key from environment variables
if (process.env.GOOGLE_API_KEY) {
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$lib$2f$chatModel$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["initializeChatModel"])(process.env.GOOGLE_API_KEY);
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$lib$2f$vectorStore$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["initializeEmbeddings"])(process.env.GOOGLE_API_KEY);
}
async function POST(req) {
    try {
        // Check for Google API key
        if (!process.env.GOOGLE_API_KEY) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'Google API key is not configured'
            }, {
                status: 500
            });
        }
        // Parse the request body
        const body = await req.json();
        const { messages } = body;
        if (!messages || !Array.isArray(messages) || messages.length === 0) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'Messages array is required'
            }, {
                status: 400
            });
        }
        // Extract the latest user message
        const latestMessage = messages[messages.length - 1];
        if (latestMessage.role !== 'user') {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'Last message must be from user'
            }, {
                status: 400
            });
        }
        // Generate a response
        const response = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$lib$2f$chatModel$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["generateResponse"])(latestMessage.content);
        // Return the response
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            role: 'assistant',
            content: response
        });
    } catch (error) {
        console.error('Error processing chat request:', error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: 'An error occurred while generating the response'
        }, {
            status: 500
        });
    }
}
}}),

};

//# sourceMappingURL=%5Broot-of-the-server%5D__0c68e4b5._.js.map